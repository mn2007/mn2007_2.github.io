---
layout: default
title: conductivity
permalink: /conductivity
---

# 電気伝導度

拡張機能をご使用になりたい場合はアカデメイアまで[お問い合わせ](https://www.academeia15.co.jp/akaikkrform)下さい。

## 入力ファイルの準備および実行

電気伝導度の計算は、以下のインプットファイルにより行える。このファイルは本チュートリアルの"go"計算のところで利用した[Inputファイル](../md/input.md)を一部書き換えたものになる。

```
c----------------------Fe------------------------------------
c    go   file
     cnd  data/fe
c------------------------------------------------------------
c   brvtyp     a        c/a   b/a   alpha   beta   gamma
     bcc      5.27  ,      ,      ,      ,       ,      ,
c------------------------------------------------------------
c   edelt    ewidth    reltyp   sdftyp   magtyp   record
    0.001     1.0       nrl     mjwasa     mag      2nd
c------------------------------------------------------------
c   outtyp    bzqlty   maxitr   pmix
    update     4:20      50    0.023
c------------------------------------------------------------
c    ntyp
      1
c------------------------------------------------------------
c   type    ncmp    rmt    field   mxl  anclr   conc
    Fe       1       1      0.0     2
                                          26    100
c------------------------------------------------------------
c   natm
     1
c------------------------------------------------------------
c   atmicx                        type
     0          0          0        Fe
c------------------------------------------------------------
```

"go"を"cnd"に書き換えることで電気伝導度の計算になる。デフォルトではz方向の伝導度を計算するが、"cndx"のようにcndにはx,yの文字を追加することができ、x方向、y方向の伝導度を計算することができる。また、"cndnv"や"cndxnv"のように"nv"という文字を追加することもできる。nvはvertex補正を入れないことを意味する。vertex補正は効く場合と効かない場合があり、デフォルトでは補正有りとなっているが、系によってはvertex補正の計算コストは大きくなるため、nvによって補正を入れないことが可能である。なお、cnd,x,nvなどの文字については並べる順番は任意である。

sdftyp(汎関数)を指定する際に、asaという文字を追加している。asaはatomic sphere approximation(原子球近似)の略であり、指定することでマフィンティン球の空隙であった領域も伝導度計算の際の積分の範囲に含めることができるため、asaを指定する方が望ましい。

bzqltyは"4:20"としている。コロンの前の数字(4)はSCF計算におけるBrillouin Zone Quality、コロンの後の数字(20)は伝導度計算におけるBrillouin Zone Qualityである。

入力ファイルの準備ができたら、goによる計算と同様の方法で実行できる。
```
$ ./specx < in/fe
```

## 出力の解説

goによる計算と同様の結果が表示された後、電気伝導度に関する出力が得られる。まずは、電気伝導に関わる角運動量と係数の表示が行われる。係数が$10^{-6}$より大きいものが表示されている。
```
 x
   # J1 J2   coefficient
 ------------------------
   1  1  4     0.57735
   2  2  5     0.44721
   3  3  8     0.44721
   4  4  7    -0.25820
   5  4  9     0.44721

 y
   # J1 J2   coefficient
 ------------------------
   1  1  2     0.57735
   2  2  7    -0.25820
   3  2  9    -0.44721
   4  3  6     0.44721
   5  4  5     0.44721

 z
   # J1 J2   coefficient
 ------------------------
   1  1  3     0.57735
   2  2  6     0.44721
   3  3  7     0.51640
   4  4  8     0.44721
```

その後、upspinについての計算結果が表示される。今回はntypの数が1なので"DOS of component"には1つ表示される。ntypが2以上のときはntypの数の分だけ同種の情報が表示される。また、今回はz方向の伝導度を計算している(入力が"cnd"だったので、デフォルト値であるz軸方向の伝導度を計算している)ためconductivity componentには3と表示されている。xなら1、yなら2である。cnd1がupspinの伝導度の値である。

```
 *** vertex correction made
  1  1  2.64906E+00 -5.34215E+01  1.03559E+02  2.86511E+01
  2  1  5.67929E+00 -5.65997E+01  2.74268E+02 -6.00371E+00
  3  1  4.52000E-01 -8.80111E+00  2.07948E+02 -4.42147E+01

 DOS of component 1
     energy      sdosup      pdosup      ddosup
  -5.0000E-01  2.7290E+00  3.6748E-01  3.6620E-01
   0.0000E+00  1.7563E-01  4.6344E-01  1.1020E+01
   5.0000E-01  3.3972E-02  4.0795E-01  2.9994E-01

 conductivity component=  3
      energy      cndup
  -5.000000E-01  1.847851E+00
   0.000000E+00  4.870628E+00
   5.000000E-01  3.625819E+00

 cnd1               4.87063 (a.u.)
```

次に、downspinについての計算結果が表示される。cnd2がdownspinの伝導度の値である。
```
 *** vertex correction made
  1  1  8.52872E-01 -2.26020E+01  9.74225E+01 -3.99645E+01
  2  1  4.05565E+00 -4.25912E+01  2.03114E+02  2.26439E+01
  3  1  2.52897E-01 -6.17646E+00  3.00362E+02 -6.10675E+01

 DOS of component 1
     energy      sdosdn      pdosdn      ddosdn
  -5.0000E-01  1.1497E+00  2.8748E-01  1.9757E-01
   0.0000E+00  1.5863E-01  4.2304E-01  9.3679E+00
   5.0000E-01  1.5742E-02  2.9536E-01  2.3932E-01

 conductivity component=  3
      energy      cnddown
  -5.000000E-01  1.709831E+00
   0.000000E+00  3.604408E+00
   5.000000E-01  5.230198E+00

 cnd2               3.60441 (a.u.)
```
なお、magtypには"mag"が入力されており、upspinとdownspinでは異なる状態を取ることが許容されている("nmag"では同じ状態しか取れない)。DOSがupspinとdownspinで異なる分布を示すように、conductivityもcnd1(upspin)とcnd2(downspin)で違う値を取っている。最後に、upspinとdownspinの伝導度の和(全伝導度)が表示され計算が終了する。
```
 *** summary ***
 cnductivity        8.47504 (a.u.)
 resistivity        5.13033 (micro ohm cm)
```